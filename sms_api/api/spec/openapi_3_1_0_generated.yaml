openapi: 3.1.0
info:
  title: sms-api
  version: 0.4.4
paths:
  /api/v1/simulations:
    post:
      tags:
      - Experiments
      summary: '[New] Launches a vEcoli simulation workflow with simple parameters'
      description: 'Run a vEcoli simulation workflow with simplified parameters.


        This endpoint reads the workflow configuration from the vEcoli repo on the
        HPC

        system and allows overriding specific parameters via query params.'
      operationId: run-ecoli-simulation-new
      parameters:
      - name: simulator_id
        in: query
        required: true
        schema:
          type: integer
          description: Database ID of the simulator to use
          title: Simulator Id
        description: Database ID of the simulator to use
      - name: experiment_id
        in: query
        required: true
        schema:
          type: string
          description: Unique experiment identifier
          title: Experiment Id
        description: Unique experiment identifier
      - name: simulation_config_filename
        in: query
        required: true
        schema:
          type: string
          description: Config filename in vEcoli/configs/ on HPC
          title: Simulation Config Filename
        description: Config filename in vEcoli/configs/ on HPC
      - name: num_generations
        in: query
        required: false
        schema:
          anyOf:
          - type: integer
            maximum: 10
            minimum: 1
          - type: 'null'
          description: Number of generations to simulate
          title: Num Generations
        description: Number of generations to simulate
      - name: num_seeds
        in: query
        required: false
        schema:
          anyOf:
          - type: integer
            maximum: 100
            minimum: 1
          - type: 'null'
          description: Number of initial seeds (lineages)
          title: Num Seeds
        description: Number of initial seeds (lineages)
      - name: description
        in: query
        required: false
        schema:
          anyOf:
          - type: string
          - type: 'null'
          description: Description of the simulation
          title: Description
        description: Description of the simulation
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Simulation'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
    get:
      tags:
      - Experiments
      summary: List all simulation specs uploaded to the database
      operationId: list-ecoli-simulations
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Simulation'
                title: Response List-Ecoli-Simulations
  /api/v1/simulations/{id}:
    get:
      tags:
      - Experiments
      summary: Get Simulation
      operationId: get-ecoli-simulation
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          description: Database ID of the simulation
          title: Id
        description: Database ID of the simulation
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                anyOf:
                - $ref: '#/components/schemas/Simulation'
                - type: 'null'
                title: Response Get-Ecoli-Simulation
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/simulations/{id}/status:
    get:
      tags:
      - Experiments
      summary: Get the simulation status record by its ID
      operationId: get-ecoli-simulation-status
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          title: Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SimulationRun'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/simulations/{id}/data:
    post:
      tags:
      - Experiments
      summary: Get simulation omics data in TSV format
      operationId: get-ecoli-simulation-data
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          description: Database ID of the simulation.
          title: Id
        description: Database ID of the simulation.
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TsvOutputFile'
                title: Response Get-Ecoli-Simulation-Data
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/analyses:
    post:
      tags:
      - Analyses
      summary: Run an analysis
      operationId: run-ecoli-simulation-analysis
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExperimentAnalysisRequest'
              default:
                experiment_id: sms_multiseed_0-2794dfa74b9cf37c_1759844363435
                multiseed:
                - name: ptools_rna
                  n_tp: 8
                  variant: 0
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  anyOf:
                  - $ref: '#/components/schemas/TsvOutputFile'
                  - $ref: '#/components/schemas/OutputFileMetadata'
                type: array
                title: Response Run-Ecoli-Simulation-Analysis
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/analyses/{id}:
    get:
      tags:
      - Analyses
      summary: Retrieve an experiment analysis spec from the database
      operationId: get-analysis
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          title: Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentAnalysisDTO'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/analyses/{id}/status:
    get:
      tags:
      - Analyses
      summary: Get the status of an existing experiment analysis run
      operationId: get-analysis-status
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          description: Database ID of the analysis
          title: Id
        description: Database ID of the analysis
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalysisRun'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/analyses/{id}/log:
    get:
      tags:
      - Analyses
      summary: Get the log of an existing experiment analysis run
      operationId: get-analysis-log
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          description: Database ID of the analysis
          title: Id
        description: Database ID of the analysis
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: string
                title: Response Get-Analysis-Log
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /api/v1/analyses/{id}/plots:
    get:
      tags:
      - Analyses
      summary: Get an array of HTML files representing all plot outputs of a given
        analysis.
      operationId: get-analysis-plots
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          description: Database ID of the analysis
          title: Id
        description: Database ID of the analysis
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutputFile'
                title: Response Get-Analysis-Plots
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /core/v1/simulator/latest:
    get:
      tags:
      - EcoliSim
      summary: Get the latest simulator version
      operationId: get-latest-simulator
      parameters:
      - name: git_repo_url
        in: query
        required: false
        schema:
          type: string
          default: https://github.com/vivarium-collective/vEcoli
          title: Git Repo Url
      - name: git_branch
        in: query
        required: false
        schema:
          type: string
          default: api-support
          title: Git Branch
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Simulator'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /core/v1/simulator/versions:
    get:
      tags:
      - EcoliSim
      summary: get the list of available simulator versions
      operationId: get-simulator-versions
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisteredSimulators'
  /core/v1/simulator/status:
    get:
      tags:
      - EcoliSim
      summary: Get simulator container build status by its ID
      operationId: get-simulator-status
      parameters:
      - name: simulator_id
        in: query
        required: true
        schema:
          type: integer
          title: Simulator Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HpcRun'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /core/v1/simulator/upload:
    post:
      tags:
      - EcoliSim
      summary: Upload a new simulator (vEcoli) version.
      operationId: insert-simulator-version
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Simulator'
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SimulatorVersion'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /core/v1/simulation/parca:
    post:
      tags:
      - EcoliSim
      summary: Run a parameter calculation
      operationId: run-parca
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ParcaDatasetRequest'
              default:
                simulator_version:
                  git_commit_hash: 540e426
                  git_repo_url: https://github.com/vivarium-collective/vEcoli
                  git_branch: api-support
                  database_id: 25
                  created_at: '2026-01-21T19:38:52.720478'
                parca_config:
                  outdir: /projects/SMS/sms_api/alex/sims
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ParcaDataset'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /core/v1/simulation/parca/versions:
    get:
      tags:
      - EcoliSim
      summary: Get list of parca calculations
      operationId: get-parca-versions
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  $ref: '#/components/schemas/ParcaDataset'
                type: array
                title: Response Get-Parca-Versions
  /core/v1/simulation/parca/status:
    get:
      tags:
      - EcoliSim
      summary: Get parca calculation status by its ID
      operationId: get-parca-status
      parameters:
      - name: parca_id
        in: query
        required: true
        schema:
          type: integer
          title: Parca Id
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HpcRun'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HTTPValidationError'
  /:
    get:
      summary: Redirect Old Path
      operationId: redirect_old_path__get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /home:
    get:
      tags:
      - SMS API
      summary: Home
      operationId: home_home_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema: {}
  /health:
    get:
      tags:
      - SMS API
      summary: Check Health
      operationId: check_health_health_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                additionalProperties:
                  type: string
                type: object
                title: Response Check Health Health Get
  /version:
    get:
      tags:
      - SMS API
      summary: Get Version
      operationId: get_version_version_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: string
                title: Response Get Version Version Get
components:
  schemas:
    AnalysisConfig:
      properties:
        analysis_options:
          $ref: '#/components/schemas/AnalysisConfigOptions'
      additionalProperties: true
      type: object
      required:
      - analysis_options
      title: AnalysisConfig
    AnalysisConfigOptions:
      properties:
        experiment_id:
          items:
            type: string
          type: array
          title: Experiment Id
      additionalProperties: true
      type: object
      required:
      - experiment_id
      title: AnalysisConfigOptions
    AnalysisModuleConfig:
      properties:
        name:
          type: string
          title: Name
        files:
          anyOf:
          - items:
              $ref: '#/components/schemas/OutputFileMetadata'
            type: array
          - type: 'null'
          title: Files
      additionalProperties: true
      type: object
      required:
      - name
      title: AnalysisModuleConfig
    AnalysisOptions:
      properties:
        cpus:
          anyOf:
          - type: integer
          - type: 'null'
          title: Cpus
        memory_gb:
          type: integer
          title: Memory Gb
          default: 8
      additionalProperties: true
      type: object
      title: AnalysisOptions
    AnalysisRun:
      properties:
        id:
          type: integer
          title: Id
        status:
          $ref: '#/components/schemas/JobStatus'
        job_id:
          anyOf:
          - type: integer
          - type: 'null'
          title: Job Id
        error_log:
          anyOf:
          - type: string
          - type: 'null'
          title: Error Log
      type: object
      required:
      - id
      - status
      title: AnalysisRun
    ExperimentAnalysisDTO:
      properties:
        database_id:
          type: integer
          title: Database Id
        name:
          type: string
          title: Name
        config:
          $ref: '#/components/schemas/AnalysisConfig'
        last_updated:
          type: string
          title: Last Updated
        job_name:
          anyOf:
          - type: string
          - type: 'null'
          title: Job Name
        job_id:
          anyOf:
          - type: integer
          - type: 'null'
          title: Job Id
      type: object
      required:
      - database_id
      - name
      - config
      - last_updated
      title: ExperimentAnalysisDTO
      description: "DTO returned by /analyses .. endpoints\n\nAttributes:\n    database_id:\
        \ (``int``) unique identifier of analysis record.\n    name: (``str``) analysis\
        \ name.\n    config: (``AnalysisConfig``) data model whose serialized format\n\
        \        represents a valid analysis config ingestible by vEcoli.\n    job_name:\
        \ (``str | None``) SLURM analysis job name referenced by sbatch directives.\n\
        \    job_id: (``int | None``) SLURM analysis job id generated by the ``sbatch``\
        \ evocation.\n        Defaults to ``None`` (such that this object can be partially\
        \ instantiated)."
    ExperimentAnalysisRequest:
      properties:
        experiment_id:
          type: string
          title: Experiment Id
        single:
          anyOf:
          - items:
              anyOf:
              - $ref: '#/components/schemas/AnalysisModuleConfig'
              - $ref: '#/components/schemas/PtoolsAnalysisConfig'
            type: array
          - type: 'null'
          title: Single
        multidaughter:
          anyOf:
          - items:
              anyOf:
              - $ref: '#/components/schemas/AnalysisModuleConfig'
              - $ref: '#/components/schemas/PtoolsAnalysisConfig'
            type: array
          - type: 'null'
          title: Multidaughter
        multigeneration:
          anyOf:
          - items:
              anyOf:
              - $ref: '#/components/schemas/AnalysisModuleConfig'
              - $ref: '#/components/schemas/PtoolsAnalysisConfig'
            type: array
          - type: 'null'
          title: Multigeneration
        multiseed:
          anyOf:
          - items:
              anyOf:
              - $ref: '#/components/schemas/AnalysisModuleConfig'
              - $ref: '#/components/schemas/PtoolsAnalysisConfig'
            type: array
          - type: 'null'
          title: Multiseed
        multivariant:
          anyOf:
          - items:
              anyOf:
              - $ref: '#/components/schemas/AnalysisModuleConfig'
              - $ref: '#/components/schemas/PtoolsAnalysisConfig'
            type: array
          - type: 'null'
          title: Multivariant
        multiexperiment:
          anyOf:
          - items:
              anyOf:
              - $ref: '#/components/schemas/AnalysisModuleConfig'
              - $ref: '#/components/schemas/PtoolsAnalysisConfig'
            type: array
          - type: 'null'
          title: Multiexperiment
      type: object
      required:
      - experiment_id
      title: ExperimentAnalysisRequest
    HTTPValidationError:
      properties:
        detail:
          items:
            $ref: '#/components/schemas/ValidationError'
          type: array
          title: Detail
      type: object
      title: HTTPValidationError
    HpcRun:
      properties:
        database_id:
          type: integer
          title: Database Id
        slurmjobid:
          type: integer
          title: Slurmjobid
        correlation_id:
          type: string
          title: Correlation Id
        job_type:
          $ref: '#/components/schemas/JobType'
        ref_id:
          type: integer
          title: Ref Id
        status:
          anyOf:
          - $ref: '#/components/schemas/JobStatus'
          - type: 'null'
        start_time:
          anyOf:
          - type: string
          - type: 'null'
          title: Start Time
        end_time:
          anyOf:
          - type: string
          - type: 'null'
          title: End Time
        error_message:
          anyOf:
          - type: string
          - type: 'null'
          title: Error Message
      additionalProperties: true
      type: object
      required:
      - database_id
      - slurmjobid
      - correlation_id
      - job_type
      - ref_id
      title: HpcRun
    JobStatus:
      type: string
      enum:
      - unknown
      - waiting
      - pending
      - queued
      - running
      - completed
      - failed
      title: JobStatus
      description: Shared job status enum for simulations, analyses, and other HPC
        jobs.
    JobType:
      type: string
      enum:
      - analysis
      - simulation
      - parca
      - build_image
      title: JobType
    OutputFile:
      properties:
        name:
          type: string
          title: Name
        content:
          type: string
          title: Content
      type: object
      required:
      - name
      - content
      title: OutputFile
    OutputFileMetadata:
      properties:
        filename:
          type: string
          title: Filename
        variant:
          type: integer
          title: Variant
          default: 0
        lineage_seed:
          anyOf:
          - type: integer
          - type: 'null'
          title: Lineage Seed
        generation:
          anyOf:
          - type: integer
          - type: 'null'
          title: Generation
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
        content:
          anyOf:
          - type: string
          - type: 'null'
          title: Content
      type: object
      required:
      - filename
      title: OutputFileMetadata
    ParcaDataset:
      properties:
        database_id:
          type: integer
          title: Database Id
        parca_dataset_request:
          $ref: '#/components/schemas/ParcaDatasetRequest'
        remote_archive_path:
          anyOf:
          - type: string
          - type: 'null'
          title: Remote Archive Path
      additionalProperties: true
      type: object
      required:
      - database_id
      - parca_dataset_request
      title: ParcaDataset
    ParcaDatasetRequest:
      properties:
        simulator_version:
          $ref: '#/components/schemas/SimulatorVersion'
        parca_config:
          $ref: '#/components/schemas/ParcaOptions'
          default:
            outdir: /projects/SMS/sms_api/alex/sims
      additionalProperties: true
      type: object
      required:
      - simulator_version
      title: ParcaDatasetRequest
    ParcaOptions:
      properties:
        outdir:
          type: string
          title: Outdir
          default: /projects/SMS/sms_api/alex/sims
      additionalProperties: true
      type: object
      title: ParcaOptions
    PtoolsAnalysisConfig:
      properties:
        name:
          type: string
          title: Name
          default: ptools_rxns
        n_tp:
          type: integer
          title: N Tp
          default: 8
        variant:
          type: integer
          title: Variant
          default: 0
        generation:
          anyOf:
          - type: integer
          - type: 'null'
          title: Generation
        lineage_seed:
          anyOf:
          - type: integer
          - type: 'null'
          title: Lineage Seed
        agent_id:
          anyOf:
          - type: integer
          - type: 'null'
          title: Agent Id
        files:
          anyOf:
          - items:
              $ref: '#/components/schemas/OutputFileMetadata'
            type: array
          - type: 'null'
          title: Files
      type: object
      title: PtoolsAnalysisConfig
      description: ":param name: (str) Analysis module type name...\n    (One of [\"\
        ptools_rxns\", \"ptools_rna\", \"ptools_proteins\"]). Defaults to \"ptools_rxns\"\
        .\n:param n_tp: (int) Number of timepoints/columns to use in the tsv\n:param\
        \ files: (list[OutputFileMetadata]) Specification of files requested to be\
        \ returned\n    with the completion of the analysis."
    RegisteredSimulators:
      properties:
        versions:
          items:
            $ref: '#/components/schemas/SimulatorVersion'
          type: array
          title: Versions
        timestamp:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: Timestamp
      additionalProperties: true
      type: object
      required:
      - versions
      title: RegisteredSimulators
    Simulation:
      properties:
        database_id:
          type: integer
          title: Database Id
        simulator_id:
          type: integer
          title: Simulator Id
        parca_dataset_id:
          type: integer
          title: Parca Dataset Id
        config:
          $ref: '#/components/schemas/SimulationConfig'
        simulation_config_filename:
          type: string
          title: Simulation Config Filename
        experiment_id:
          type: string
          title: Experiment Id
        last_updated:
          type: string
          title: Last Updated
          default: '2026-01-21 19:38:51.864376'
        job_id:
          anyOf:
          - type: integer
          - type: 'null'
          title: Job Id
      additionalProperties: true
      type: object
      required:
      - database_id
      - simulator_id
      - parca_dataset_id
      - config
      - simulation_config_filename
      - experiment_id
      title: Simulation
      description: Used by the /simulation endpoint
    SimulationConfig:
      properties:
        experiment_id:
          type: string
          title: Experiment Id
        parca_options:
          $ref: '#/components/schemas/ParcaOptions'
          default:
            outdir: /projects/SMS/sms_api/alex/sims
        analysis_options:
          $ref: '#/components/schemas/AnalysisOptions'
          default:
            memory_gb: 8
        generations:
          type: integer
          title: Generations
          default: 1
      additionalProperties: true
      type: object
      required:
      - experiment_id
      title: SimulationConfig
    SimulationRun:
      properties:
        id:
          type: integer
          title: Id
        status:
          $ref: '#/components/schemas/JobStatus'
      additionalProperties: true
      type: object
      required:
      - id
      - status
      title: SimulationRun
    Simulator:
      properties:
        git_commit_hash:
          type: string
          title: Git Commit Hash
        git_repo_url:
          type: string
          title: Git Repo Url
        git_branch:
          type: string
          title: Git Branch
      additionalProperties: true
      type: object
      required:
      - git_commit_hash
      - git_repo_url
      - git_branch
      title: Simulator
    SimulatorVersion:
      properties:
        git_commit_hash:
          type: string
          title: Git Commit Hash
        git_repo_url:
          type: string
          title: Git Repo Url
        git_branch:
          type: string
          title: Git Branch
        database_id:
          type: integer
          title: Database Id
        created_at:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: Created At
      additionalProperties: true
      type: object
      required:
      - git_commit_hash
      - git_repo_url
      - git_branch
      - database_id
      title: SimulatorVersion
    TsvOutputFile:
      properties:
        filename:
          type: string
          title: Filename
        variant:
          type: integer
          title: Variant
          default: 0
        lineage_seed:
          anyOf:
          - type: integer
          - type: 'null'
          title: Lineage Seed
        generation:
          anyOf:
          - type: integer
          - type: 'null'
          title: Generation
        agent_id:
          anyOf:
          - type: string
          - type: 'null'
          title: Agent Id
        content:
          anyOf:
          - type: string
          - type: 'null'
          title: Content
      type: object
      required:
      - filename
      title: TsvOutputFile
    ValidationError:
      properties:
        loc:
          items:
            anyOf:
            - type: string
            - type: integer
          type: array
          title: Location
        msg:
          type: string
          title: Message
        type:
          type: string
          title: Error Type
      type: object
      required:
      - loc
      - msg
      - type
      title: ValidationError
