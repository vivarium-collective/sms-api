# SMS REST API Documentation

## Base Url:
### `https://sms.cam.uchc.edu`


## Endpoints:
### - (`GET`) `/core/download/analysis`: Download any analysis file generated during a simulation workflow.

#### Query Parameters:
- `experiment_id`: (`str`) Experiment ID of the corresponding simulation for which you wish to fetch analysis outputs. **EXAMPLE**: `sms_single`
- `filename`: (`str`) File name and extension of the analysis file that you wish to fetch.  **EXAMPLE**: `ptools_rna.txt`

#### Returns:
The requested analysis file as a download.

#### Example (Javascript):
_Download the TSV file required by Pathway Tools generated by the example simulation analysis workflow_:
```javascript
async function downloadFile() {
  const experimentId = "sms_single";
  const filename = "ptools_rna.txt";
  const baseUrl = "https://sms.cam.uchc.edu"
  const url = `${baseUrl}/core/download/analysis?experiment_id=${encodeURIComponent(experimentId)}&filename=${encodeURIComponent(filename)}`;

  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error("Network response was not ok");

    const blob = await response.blob();
    const downloadUrl = window.URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = downloadUrl;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    window.URL.revokeObjectURL(downloadUrl);
  } catch (error) {
    console.error("Download failed:", error);
  }
}
```

### - (`POST`) `/core/download/parquet`: Download the parquet files generated by a simulation workflow as a `.zip` file

#### Query Parameters:
- `experiment_id`: (`str`) Experiment ID of the corresponding simulation for which you wish to fetch parquet outputs. **EXAMPLE**: `sms_single`

#### Returns:
The requested simulation parquet files as a zip download.

#### Example (Python):
_Download the example simulation output parquet files as a zip file_:
```python
import requests

def download_parquet():
    url = "https://sms.cam.uchc.edu/core/download/parquet?experiment_id=sms_single"

    response = requests.post(url, headers={"Accept": "*/*"})

    if response.status_code != 200:
        raise Exception(f"HTTP error! status: {response.status_code}")

    with open("download.parquet", "wb") as f:
        f.write(response.content)


download_parquet()
```

#### Example (Javascript):
_Download the example simulation output parquet files as a zip file_:
```javascript
async function downloadParquet() {
  const response = await fetch('https://sms.cam.uchc.edu/core/download/parquet?experiment_id=sms_single', {
    method: 'POST',
    headers: {
      'Accept': '*/*',
    },
    body: '', // Empty body, otherwise the simulation observables you wish to return
  });

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  const blob = await response.blob();

  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'download.parquet'; // You can customize the file name
  document.body.appendChild(a);
  a.click();
  a.remove();
  window.URL.revokeObjectURL(url);
}
```
